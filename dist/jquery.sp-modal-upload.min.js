/*! jQuery.spModalUpload v0.1.0 | Copyright (c) 2015 Gonzalo Chumillas | https://github.com/soloproyectos-js/jquery.sp-modal-upload/blob/master/LICENSE */
!function(t){t.spModalUploadClass=function(e,s,a){this._input="string"==t.type(e)?t(e):e,this._url=s,this._data=a},t.spModalUploadClass.prototype._input=null,t.spModalUploadClass.prototype._url="",t.spModalUploadClass.prototype._data={},t.spModalUploadClass.prototype.send=function(){var e=new t.Deferred,s=new FormData,a=null;this._input.each(function(){var e=t(this),a=e.attr("name"),n=this.files[0];("string"!=t.type(a)||0==a.length)&&t.error('Attribute "name" is required for the input file'),void 0!==n&&s.append(a,n)}),void 0!==this._data&&t.each(this._data,function(t,e){s.append(t,e)});var n=new t.spModalProgress("Uploading file...");n.addButton("Cancel Upload",function(){n.close(),null!=a&&a.abort()});var a=new XMLHttpRequest;return a.upload.addEventListener("progress",function(e){var s="number"==t.type(e.total)?e.total:100,a="number"==t.type(e.loaded)?e.loaded:0;n.setValue(a/s)},!1),a.addEventListener("readystatechange",function(){if(4==a.readyState){n.close();var s=""+a.status;if(!s.match(/^2\d{2}$/)){var o="string"==t.type(a.responseText)&&a.responseText.length>0?a.responseText:"The request has failed",r="string"==t.type(a.statusText)&&a.statusText.length>0?a.statusText:"HTTP Request Error";t.spModal("error",r,o,function(){var t=(o.match(/\n/g)||[]).length;console.log(t),t>1&&this.setTextAlign("left"),e.reject(xhr,s)})}e.resolve(a.responseText,"sucess",a)}},!1),a.open("POST",this._url,!0),a.send(s),e.promise()}}(jQuery),function(t){t.spModalUpload=function(e,s,a){var n=new t.spModalUploadClass(e,s,a);return n.send()}}(jQuery);